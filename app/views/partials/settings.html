<div id="settings">
	<form ng-submit="save()">
		<tabset>
			<tab heading="General">
				<div class="panel panel-info">
					<div class="panel-heading">
						<h4 class="panel-title">Media</h4>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<label for="ipt_shows_base">Base Media Directory</label>
							
							<div class="input-group">
								<input type="text" id="ipt_shows_base" name="shows:base" ng-model="settings.shows.base" class="form-control" />
								<span class="input-group-addon">
									<span class="glyphicon glyphicon-folder-open"></span>
								</span>
							</div>
						</div>
						<div class="form-group">
							<label class="checkbox-inline">
								<input type="checkbox" id="ipt_shows_hd" name="shows:hd" ng-model="settings.shows.hd" />
								<strong>Prefer HD Video</strong>
							</label>
						</div>
					</div>
				</div>
			
				<div class="panel panel-info">
					<div class="panel-heading">
						<h4 class="panel-title">Transmission RPC</h4>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<label for="ipt_bt_username">Username</label>
							<input type="text" id="ipt_bt_username" name="transmission:username" ng-model="settings.transmission.username" class="form-control" />
						</div>
						<div class="form-group">
							<label for="ipt_bt_password">Password</label>
							<input type="password" id="ipt_bt_password" name="transmission:password" ng-model="settings.transmission.password" class="form-control" />
						</div>
						<div class="form-group">
							<label for="ipt_bt_host">Host</label>
							<input type="text" id="ipt_bt_host" name="transmission:host" ng-model="settings.transmission.host" class="form-control" />
						</div>
						<div class="form-group">
							<label for="ipt_bt_port">Port</label>
							<input type="text" for="ipt_bt_port" name="transmission:port" ng-model="settings.transmission.port" class="form-control" />
						</div>
					</div>
				</div>
			
				<div class="panel panel-info">
					<div class="panel-heading">
						<h4 class="panel-title">Trakt</h4>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<label class="checkbox-inline">
								<input type="checkbox" id="ipt_trakt_enable" name="trakt:enabled" ng-model="settings.trakt.enabled" />
								<strong>Enable Integration</strong>
							</label>
						</div>
						<div ng-switch on="settings.trakt.enabled">
							<div class="alert alert-danger" ng-switch-when="false"><strong>Note</strong>: Trakt integration is <strong>required</strong></div>
							<div class="form-group" ng-switch-when="true">
								<label for="ipt_trakt_username">Username</label>
								<input type="text" id="ipt_trakt_username" name="trakt:username" ng-model="settings.trakt.username" class="form-control" />
							</div>
							<div class="form-group" ng-switch-when="true">
								<label for="ipt_trakt_password">Password</label>
								<input type="password" id="ipt_trakt_password" name="trakt:password" ng-model="settings.trakt.password" class="form-control" />
							</div>
							<div class="form-group" ng-switch-when="true">
								<label for="ipt_trakt_api">API Key</label>
								<input type="text" id="ipt_trakt_api" name="trakt:apikey" ng-model="settings.trakt.apikey" class="form-control" />
							</div>
						</div>
					</div>
				</div>
				
				<div class="panel panel-info">
					<div class="panel-heading">
						<h4 class="panel-title">Twilio</h4>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<label class="checkbox-inline">
								<input type="checkbox" id="ipt_twilio_enabled" name="twilio:enabled" ng-model="settings.twilio.enabled" />
								<strong>Enable SMS Notifications</strong>
							</label>
						</div>
						<div ng-switch on="settings.twilio.enabled">
							<div class="alert alert-warning" ng-switch-when="false"><strong>Note</strong>: SMS integration is not yet functional</div>
							<div class="form-group" ng-switch-when="true">
								<label for="ipt_twilio_phone">Phone</label>
								<input type="text" id="ipt_twilio_phone" name="twilio:phone" ng-model="settings.twilio.phone" class="form-control" />
							</div>
							<div class="form-group" ng-switch-when="true">
								<label for="ipt_twilio_sid">SID</label>
								<input type="text" id="ipt_twilio_sid" name="twilio:sid" ng-model="settings.twilio.sid" class="form-control" />
							</div>
							<div class="form-group" ng-switch-when="true">
								<label for="ipt_twilio_token">Token</label>
								<input type="text" id="ipt_twilio_token" name="twilio:token" ng-model="settings.twilio.token" class="form-control" />
							</div>
						</div>
					</div>
				</div>
			</tab>
		
			<tab heading="Security">
				<div class="panel panel-info" >
					<div class="panel-heading">
						<h4 class="panel-title">Users</h4>
					</div>
					<div class="panel-body">
						<table class="table table-condensed table-hover" ng-if="users.length>0">
							<thead>
								<tr>
									<th>Username</th>
									<th>Email</th>
									<th>Enabled</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="user in users">
									<td>{{user.username}}</td>
									<td>&nbsp;</td>
									<td></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="panel panel-info">
					<div class="panel-heading">
						<h4 class="panel-title">Network Security</h4>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<label for="ipt_security_whitelist">IP Whitelist</label>
							<input type="text" id="ipt_security_whitelist" name="security:whitelist" ng-model="settings.security.whitelist" class="form-control" />
						</div>
						<div class="well">
							Users from the allowed IP ranges will not be required to log in.
						</div>
					</div>
				</div>
			</tab>
			
			<tab heading="System">
				<div class="panel panel-warning">
					<div class="panel-heading">
						<h4 class="panel-title">Library Maintenance</h4>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<button type="button" class="btn btn-info" ng-click="listings()">Update listings</button>
							<button type="button" class="btn btn-primary" ng-click="rescan()">Rescan Media</button>
						</div>
						<div class="well well-sm">NodeTV automatically updates show listings at 1am every Sunday.</div>
						<div class="form-group">
							<button type="button" class="btn btn-info" ng-click="latest()">Check for downloads</button>
						</div>
						<div class="well well-sm">NodeTV automatically checks for new downloads every 30 minutes.</div>
					</div>
				</div>
				<div class="panel panel-danger">
					<div class="panel-heading">
						<h4 class="panel-title">System Maintenance</h4>
					</div>
					<div class="panel-body">
						<div class="form-group">
							<label for="ipt_system_branch">Update channel</label>
							{{settings.system.derp}}
							<select name="system:branch" id="ipt_system_branch" ng-model="settings.system.branch" ng-options="branch.name as branch.name for branch in branches" class="form-control"></select>
						</div>
						<div class="form-group">
							<button type="button" class="btn btn-warning" ng-click="update()">Update</button>
							<button type="button" class="btn btn-danger" ng-click="reboot()">Restart</button>
						</div>
						<br />
						<div class="well well-sm">NodeTV checks for system updates at 3am every night, and automatically installs if available.</div>
					</div>
				</div>
			</tab>
		</tabset>
		
		<div class="toolbar">
			<button type="submit" class="btn btn-success">Save settings</button>
		</div>
	</form>
</div>