var crypto	= require('crypto'),
	extend	= require('xtend'),
	log4js	= require('log4js'),
	Q		= require('q'),
	request	= require('request');

log4js.configure({
	appenders: [{
		type: 'console'
	}],
	replaceConsole: true
});
var logger = log4js.getLogger('nodetv-trakt');


var Trakt = function(settings){
	try {
		var defaults = {
			'version': 1,
			// v1
			'username': '',
			'password': '',
			'apikey': '',
			// v2
			'sandbox': false,
			'user_token': ''
		};
		var config = extend(defaults,settings);
		
		// switch on user_token in future...
		
		if (config.version == 1){
			var API = require('./api/v1.js')(logger);
			API.init(settings);
			
		} else if (config.version == 2){
			var API = require('./api/v2.js')(logger);
			
		}
		return API;
	} catch(e){
		logger.error(e.message);
	}
}

// v1 API
module.exports = exports = Trakt;